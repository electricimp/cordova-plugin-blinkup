# Cordova BlinkUp Plug-in Sample App #

This is a sample app which that demonstrates how to use the [BlinkUp Cordova plugin](https://github.com/electricimp/cordova-plugin-blinkup) to integrate Electric Imp's BlinkUp™ SDK into Cordova apps for iOS and Android.

Please Refer to the [primary Read Me](../../README.md) for more information about the plug-in and how to install it in your own project.

For more information about Electric Imp, please visit: https://electricimp.com/.

## Prerequisites ##

* An Electric Imp development kit. For more information on how to obtain a development kit, please visit https://developer.electricimp.com/gettingstarted/devkits
* An Electric Imp developer account. To register for an account, please visit https://impcentral.electricimp.com/login
* The BlinkUp SDK and an API Key. For more information on how to obtain an API key, which are only made available to Electric Imp customers, please visit: https://support.electricimp.com/
* Xcode, Android Studio and cordova.

## Installation ##

We recommended that you build the project from the command line:

* For iOS: `cordova build ios`
* For Android: `cordova build android`.

This step will initially fail, due to missing [prerequisites](#prerequisites).

### iOS Instructions ###

Copy the `BlinkUp.embeddedframework` folder from the SDK to `/path/to/cordova-plugin-blinkup/samples/sampleapp/platforms/ios/SampleApp/Frameworks` folder.

### Android Instructions ###

Copy the `blinkup_sdk` contents (.jar or .aar file) from the BlinkUp SDK to `path/to/cordova-plugin-blinkup/samples/sampleapp/platforms/android/libs`.

#### Important ####

You will need to create a file called `cordova-plugin-blinkup/samples/sampleapp/www/js/blinkupconfig.js` based on `cordova-plugin-blinkup/samples/sampleapp/www/js/blinkupconfig.example`. This file is generated by the Xcode and/or Android Studio build.

Open `cordova-plugin-blinkup/samples/sampleapp/www/js/blinkupconfig.js` and enter your API key from Electric Imp. You can optionally set your development plan ID as well; this will let you add development imp-enabled devices to the impCentral™ IDE. Please read [**Testing the Plug-in**](#testing-the-plug0in) before setting a development plan ID, as it will prevent users from connecting if it makes it into production code.

When building, the root `index.js` file overwrites the native platform’s `index.js` file, propagating your changes to both platforms.

## Running The Sample App ##

You can run the application from within Xcode or Android Studio, or from the command line using `cordova run ios` or `cordova run android`. Make sure to run `cordova prepare <platform>` at least once before using Xcode or Android Studio.

## Project Structure ##

Refer to `cordova-plugin-blinkup/samples/sampleapp/www/js/index.js` for an example of how to call the plugin that initiates the native BlinkUp process.

## Testing the Plug-in ##

If you are testing during development, you can input your own development plan ID to add the device to your development account and see it the Electric Imp IDE. Just set it at the top of the `index.js` files and ensure you pass `false` for *generateNewPlanId*. The development plan ID you set will override a cached plan ID (if there is one) if *generateNewPlanId* is `false`. If *generateNewPlanId*  is `true`, a new plan ID will be generated every BlinkUp and the development plan ID will be ignored.

When you pass in a development plan ID, the plug-in will not cache it across BlinkUp operations. Caching only occurs with production plan IDs. It is used to ensure that if a given end-user reconfigures their device, user settings (stored on a per-agent ID basis) are not lost (because the device will get a new agent ID).

**IMPORTANT NOTE** If a development plan ID makes it into production, the end-user’s device will not configure, and will be unable to connect to WiFi. There is a check in the native code on each platform which will ignore a development plan ID if the build configuration is set to release, but it is best to remove all references to the plan ID and pass an empty string from the Javascript when you’re done debugging. Please read https://developer.electricimp.com/manufacturing/publiccloudplanids for more info.